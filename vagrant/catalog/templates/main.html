<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Music Dump</title>
	<link rel="stylesheet" href="https://storage.googleapis.com/code.getmdl.io/1.0.2/material.green-pink.min.css">
	<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
	<link rel=stylesheet type=text/css href="{{ url_for('static', filename='styles.css') }}">
	<script src="https://storage.googleapis.com/code.getmdl.io/1.0.0/material.min.js"></script>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
	<script src="//apis.google.com/js/platform.js?onload=start"></script>
</head>

<body>
	<div class="container">

		<div class="mdl-layout mdl-js-layout mdl-layout--fixed-drawer mdl-layout--fixed-header">
		  <header class="mdl-layout__header">
		    <div class="mdl-layout__header-row">
		      <div class="mdl-layout-spacer"></div>

					<div id="signInButton">
				    <span class="g-signin" data-scope="openid email" data-clientid="230694001822-0ekip5c5ul524qj07fvknk39ha7mob7h.apps.googleusercontent.com" data-redirecturi="postmessage" data-accesstype="offline" data-cookiepolicy="single_host_origin" data-callback="signInCallback"
				    data-approvalprompt="force">
				    </span>
				  </div>
					<script type="text/javascript">
				    function signInCallback(authResult) {
				      if (authResult['code']) {
				        // hide sign-in button, now that user is authorized
				        $('#signInButton').hide();
				        // send one time code to server, if the server responds write login successful and redirect
				        $.ajax({
				          type: "POST",
				          url: "/gconnect?state={{STATE}}",
				          processData: false,
				          contentType: "application/octet-stream; charset=utf-8",
				          success: function(result) {
				            if (result) {
				              $('#result').html('Login Successful!</br>' + result + '</br>Redirecting...')
				              setTimeout(function() {
				                window.location.href = "/songs";
				              }, 4000);
				            } else if (authResult['error']) {
				              console.log('There was an error: ' + authResult['error']);
				            } else {
				              $('#result').html('Failed to make a server-side call. Check your configuration and console.');
				            }
				          }
				        });
				      }
				    }
				  </script>

		    </div>
		  </header>
		  <div class="mdl-layout__drawer">
		    <span class="mdl-layout-title">music dump</span>
		    <nav class="mdl-navigation">
					{% for genre in genres %}
		      <a class="mdl-navigation__link" href="{{url_for('showSongs', genre_id = genre.id)}}">{{genre.name}}</a>
		      {% endfor %}
		    </nav>
		  </div>
		  <main class="mdl-layout__content">
		    <div class="page-content">

					{% block content %} {% endblock %}

		    </div>
		  </main>
		</div>

	</div>
</body>

</html>
